# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ excel_handler.py

## üêõ –ü—Ä–æ–±–ª–µ–º–∞
–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–º –≤—ã–≤–æ–¥–∏–ª–æ—Å—å —Å–æ–æ–±—â–µ–Ω–∏–µ:
> "‚úÖ –¢–∞–∫–ª–∏—Ñ —Å–∞“õ–ª–∞–Ω–¥–∏, –ª–µ–∫–∏–Ω –∑–∞–∫–∞–∑—á–∏–∫–Ω–∏ —Ö–∞–±–∞—Ä–¥–æ—Ä “õ–∏–ª–∏—à –º—É–º–∫–∏–Ω —ç–º–∞—Å."

## üîç –ü—Ä–∏—á–∏–Ω–∞
–í —Ñ–∞–π–ª–µ `excel_handler.py` —Ñ—É–Ω–∫—Ü–∏–∏ `create_offers_summary` –∏ `create_offers_excel` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ —Å—Ç–∞—Ä—ã–µ –∏–º–µ–Ω–∞ –ø–æ–ª–µ–π –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `offer_items`, –Ω–æ –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–π —Ç–∞–±–ª–∏—Ü—ã `seller_offer_items` –∏–º–µ–Ω–∞ –ø–æ–ª–µ–π –∏–∑–º–µ–Ω–∏–ª–∏—Å—å.

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### –°—Ç–∞—Ä—ã–µ –∏–º–µ–Ω–∞ –ø–æ–ª–µ–π:
- `price_per_unit` ‚Üí `price`
- `total_price` ‚Üí `total`
- `material_description` ‚Üí `description`

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:

#### 1. `create_offers_summary`
```python
# –ë—ã–ª–æ
summary += f"     üí∞ –¶–µ–Ω–∞ –∑–∞ –µ–¥–∏–Ω–∏—Ü—É: {item['price_per_unit']:,} —Å—É–º\n"
summary += f"     üíµ –°—É–º–º–∞: {item['total_price']:,} —Å—É–º\n"
if item['material_description']:
    summary += f"     üìù –û–ø–∏—Å–∞–Ω–∏–µ: {item['material_description']}\n"

# –°—Ç–∞–ª–æ
summary += f"     üí∞ –¶–µ–Ω–∞ –∑–∞ –µ–¥–∏–Ω–∏—Ü—É: {item['price']:,} —Å—É–º\n"
summary += f"     üíµ –°—É–º–º–∞: {item['total']:,} —Å—É–º\n"
if item['description']:
    summary += f"     üìù –û–ø–∏—Å–∞–Ω–∏–µ: {item['description']}\n"
```

#### 2. `create_offers_excel`
```python
# –ë—ã–ª–æ
ws.cell(row=row, column=7, value=item['price_per_unit'])
ws.cell(row=row, column=8, value=item['total_price'])
ws.cell(row=row, column=9, value=item['material_description'])

# –°—Ç–∞–ª–æ
ws.cell(row=row, column=7, value=item['price'])
ws.cell(row=row, column=8, value=item['total'])
ws.cell(row=row, column=9, value=item['description'])
```

## üîÑ –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç—ã

1. **–ü–æ—Å—Ç–∞–≤—â–∏–∫ —Å–æ–∑–¥–∞–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ** ‚Üí –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `seller_offer_items`
2. **–°–∏—Å—Ç–µ–º–∞ —Å–æ–∑–¥–∞–µ—Ç —Å–≤–æ–¥–∫—É** ‚Üí –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ –ø–æ–ª–µ–π
3. **–°–∏—Å—Ç–µ–º–∞ —Å–æ–∑–¥–∞–µ—Ç Excel —Ñ–∞–π–ª** ‚Üí –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ –ø–æ–ª–µ–π
4. **–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑—á–∏–∫—É** ‚Üí –†–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫

## üß™ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- ‚úÖ –°–≤–æ–¥–∫–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π —Å–æ–∑–¥–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ Excel —Ñ–∞–π–ª —Å–æ–∑–¥–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑—á–∏–∫—É –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ
- ‚úÖ –ó–∞–∫–∞–∑—á–∏–∫ –ø–æ–ª—É—á–∞–µ—Ç –ø–æ–ª–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è—Ö

## üìÅ –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. `excel_handler.py` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∏–º–µ–Ω–∞ –ø–æ–ª–µ–π –≤ —Ñ—É–Ω–∫—Ü–∏—è—Ö —Å–æ–∑–¥–∞–Ω–∏—è —Å–≤–æ–¥–∫–∏ –∏ Excel —Ñ–∞–π–ª–∞
2. `bot.py` - –¥–æ–±–∞–≤–ª–µ–Ω–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

- **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –°—Ç–∞—Ä—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –±–µ–∑ —Ç–æ–≤–∞—Ä–æ–≤ –≤ `seller_offer_items` –Ω–µ –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≤ —Å–≤–æ–¥–∫–µ
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –ø—Ä–æ–±–ª–µ–º –≤ –±—É–¥—É—â–µ–º
